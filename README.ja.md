# n8n-nodes-aivisspeech

[English](README.md) | 日本語

これはn8nコミュニティノードです。n8nワークフローで[AivisSpeech](https://github.com/Aivis-Project/AivisSpeech)（VOICEVOX互換）テキスト読み上げ機能を使用できます。

AivisSpeechは、VOICEVOX互換APIを持つ高品質な日本語テキスト読み上げエンジンです。

[n8n](https://n8n.io/)は[フェアコードライセンス](https://docs.n8n.io/reference/license/)のワークフロー自動化プラットフォームです。

[インストール](#インストール)
[操作](#操作)
[認証情報](#認証情報)
[互換性](#互換性)
[リソース](#リソース)

## インストール

n8nコミュニティノードドキュメントの[インストールガイド](https://docs.n8n.io/integrations/community-nodes/installation/)に従ってください。

### コミュニティノード（推奨）

1. **設定 > コミュニティノード** を開く
2. **インストール** を選択
3. `n8n-nodes-aivisspeech` と入力
4. **インストール** を選択

### 手動インストール

```bash
cd ~/.n8n/custom
npm init -y
npm install n8n-nodes-aivisspeech
```

## 操作

### 音声合成

| 操作 | 説明 |
|------|------|
| **話者一覧取得** | 利用可能な話者とボイススタイルの一覧を取得 |
| **音声合成（簡略）** | テキストから音声を合成（AudioQuery取得と合成を自動実行） |
| **AudioQuery取得** | テキストから読み方・アクセント情報を取得 |
| **音声合成（AudioQueryから）** | AudioQuery JSONから音声を合成 |

### ユーザー辞書

| 操作 | 説明 |
|------|------|
| **ユーザー辞書一覧取得** | 登録されている単語一覧を取得 |
| **ユーザー辞書単語追加** | 辞書に単語を追加 |
| **ユーザー辞書単語更新** | 登録済みの単語を更新 |
| **ユーザー辞書単語削除** | 辞書から単語を削除 |

### ユーザー辞書パラメータ

| パラメータ | 説明 |
|------------|------|
| **表記** | 単語の表記（例: 東京） |
| **読み（カタカナ）** | 単語の読み（例: トウキョウ） |
| **アクセント型** | アクセント核の位置。0=平板型、1以上=そのモーラで下がる |
| **単語の種類** | 固有名詞、普通名詞、動詞、形容詞、接尾辞 |
| **優先度** | 0-10（高いほど優先） |

#### アクセント型について

アクセント型は「何モーラ目で音が下がるか」を指定します。

- **モーラ**: 日本語の拍の単位。「ん」「ー」「っ」も1モーラ、「きょ」などの拗音も1モーラ
- **例**: トウキョウ = 4モーラ（ト・ウ・キョ・ウ）

| アクセント型 | 発音パターン |
|--------------|--------------|
| 0（平板型） | ト→ウ→キョ→ウ（下がらない） |
| 1（頭高型） | ト↓ウキョウ |
| 2 | トウ↓キョウ |

## 認証情報

AivisSpeech API認証情報を設定する必要があります：

| フィールド | 説明 | デフォルト |
|------------|------|------------|
| **Base URL** | AivisSpeechエンジンのURL | `http://localhost:10101` |

**Dockerユーザー**: AivisSpeechがホストマシンで動作している場合は `http://host.docker.internal:10101` を使用してください。

## 互換性

- **n8nバージョン**: 1.0.0以降
- **AivisSpeech**: VOICEVOX互換APIを持つ全バージョン
- **VOICEVOX**: VOICEVOX Engine APIと互換

## リソース

* [n8nコミュニティノードドキュメント](https://docs.n8n.io/integrations/community-nodes/)
* [AivisSpeech GitHub](https://github.com/Aivis-Project/AivisSpeech)
* [VOICEVOX APIリファレンス](https://voicevox.github.io/voicevox_engine/api/)

## 変更履歴

### 0.4.4

- 追加: 複数テキスト音声合成のテキスト毎にAudioQueryパラメータ（話速・音高・抑揚・音量・開始/終了無音）を個別指定可能に

### 0.4.3

- 追加: 複数テキスト音声合成オペレーション（`/connect_waves` で複数テキストを1つの音声に結合）
- 追加: テキスト毎の話者ID・開始/終了無音の個別指定
- 追加: GUI入力・JSON入力の切り替え
- 修正: バイナリプロパティ名が出力キー名として正しく反映されるように修正

### 0.4.2

- 追加: 音声合成（簡略）にAudioQueryパラメータ（話速・音高・抑揚・音量・無音・サンプリングレート・ステレオ）を追加
- 更新: 公式AivisSpeechアイコンに変更

### 0.4.1

- 変更: 音声合成の出力をファイル保存からバイナリデータ出力に変更
- 削除: `出力ディレクトリ` パラメータ（不要になったため）

### 0.4.0

- リファクタリング: ノードファイルをモジュール分割し、保守性を向上

### 0.3.1

- 追加: ユーザー辞書操作（一覧取得・追加・更新・削除）
- 改善: 日本語UIラベルと説明文

### 0.1.0

- 初回リリース
- 音声合成操作（話者一覧取得、音声合成、AudioQuery取得、AudioQueryからの合成）

## ライセンス

[MIT](LICENSE)
